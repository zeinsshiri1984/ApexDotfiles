#!/usr/bin/env bash
# spf-opener - 供 Superfile 调用的“伪编辑器”
# 作用：将 Superfile 选中的文件路径发送给 Helix (通过 Zellij Action)

FILEPATH="$1"

if [ -z "$FILEPATH" ]; then
    exit 0
fi

# 1. 切回上一个 Pane (假设是 Helix)
zellij action focus-previous-pane

# 2. 发送 Helix 命令
# ESC (确保 Normal 模式) -> :open <path> -> Enter
zellij action write 27
zellij action write-chars ":open $FILEPATH"
zellij action write 13

# 3. 关闭 Superfile 所在的浮窗 (因为它已经完成了使命)
# 切回浮窗 Pane (因为刚才切走了)
zellij action focus-next-pane
zellij action close-pane
