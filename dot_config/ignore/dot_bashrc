# Non-interactive? Exit.
[[ $- != *i* ]] && return

# 1. Mise Activation (Essential)
# å¿…é¡»å…ˆæ¿€æ´» Miseï¼Œæ‰èƒ½æ‰¾åˆ° config.toml ä¸­å®šä¹‰çš„ Nushell
if [ -x "$HOME/.local/bin/mise" ]; then
  eval "$($HOME/.local/bin/mise activate bash)"
fi

# 2. The Handover to Nushell (Interactive Only)
# åªæœ‰æœªå®šä¹‰ NU_VERSION ä¸” nu å‘½ä»¤å­˜åœ¨æ—¶åˆ‡æ¢
if command -v nu &> /dev/null && [ -z "${NU_VERSION-}" ]; then
    # å°è¯•å¯åŠ¨ Podman Socket (å¦‚æœæ˜¯ Systemd ç¯å¢ƒ)
    if [ ! -S "$XDG_RUNTIME_DIR/podman/podman.sock" ] && command -v systemctl &> /dev/null; then
        systemctl --user start podman.socket &> /dev/null || true
    fi
    
    # ğŸš€ Replace Bash
    exec nu
fi

# 3. Bash Fallback (Rescue Mode)
# å¦‚æœ Nushell æŒ‚äº†ï¼Œè¿™é‡Œæ˜¯æœ€åçš„é˜²çº¿
[ -f ~/.profile ] && . ~/.profile

alias ls='ls --color=auto'
alias ll='ls -alF'