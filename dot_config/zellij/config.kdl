// Zellij global config,其余未指定选项为默认值

// 基础设置
default_shell "bash"
scrollback_editor "hx"
pane_frames true
mouse_mode true
simplified_ui true
default_mode "locked"
copy_clipboard "system"
copy_on_select true
default_layout "ide"

// Session
session_serialization true
serialize_pane_viewport true
on_force_close "detach"

// UI
ui {
    pane_frames {
        rounded_corners true
        hide_session_name true
    }
}

// 快捷键
keybinds {
    // Locked 模式 (默认)
    locked {
        bind "Ctrl a" { SwitchToMode "Normal"; }
        bind "Ctrl q" { Detach; }
    }

    // RenameTab 模式
    renametab {
        bind "Enter" { SwitchToMode "Locked"; }
        bind "Esc" { UndoRenameTab; SwitchToMode "Locked"; }
    }

    // 除 RenameTab 外的所有模式
    shared_except "renametab" {
        bind "Esc" { SwitchToMode "Locked"; }
        bind "Ctrl q" { Detach; }

        // 浮动窗格
        bind "Alt y" { Run "bash" "-lc" "yz" { floating=true; close_on_exit=true; }; }
        bind "Alt g" { Run "bash" "-lc" "lazygit" { floating=true; close_on_exit=true; }; }
        bind "Alt p" { Run "bash" "-lc" "podman-tui" { floating=true; close_on_exit=true; }; }
        bind "Alt b" { Run "bash" "-lc" "btop" { floating=true; close_on_exit=true; }; }
        // --- Pane管理 ---
        bind "Alt n" { NewPane "stacked"; }               // 新建窗格(自动)
        bind "Alt r" { NewPane "Right"; }       // 强制向右分屏 (Right)
        bind "Alt d" { NewPane "Down"; }        // 强制向下分屏 (Down)
        bind "Alt x" { CloseFocus; }            // 关闭当前窗格/Tab (常用!)
        bind "Alt f" { ToggleFocusFullscreen; } // 全屏/取消全屏 (Focus)
        bind "Alt e" { TogglePaneEmbedOrFloating; } // 悬浮/平铺互转
        // --- Pane 导航 (Vim风格) ---
        bind "Alt h" "Alt Left" { MoveFocus "Left"; }
        bind "Alt l" "Alt Right" { MoveFocus "Right"; }
        bind "Alt j" "Alt Down" { MoveFocus "Down"; }
        bind "Alt k" "Alt Up" { MoveFocus "Up"; }
        // --- Pane 大小调整 ---
        bind "Alt =" { Resize "Increase"; }
        bind "Alt -" { Resize "Decrease"; }

        // --- Tab管理 ---
        bind "Alt t" { Run "bash" "-lc" "zj-worktree" { close_on_exit true; }; } // 新建 Worktree Tab
        bind "Alt [" { GoToPreviousTab; }      // 上一个 Tab
        bind "Alt ]" { GoToNextTab; }          // 下一个 Tab
        bind "Alt 1" { GoToTab 1; }            // 快速切换 1-9
        bind "Alt 2" { GoToTab 2; }
        bind "Alt 3" { GoToTab 3; }
        bind "Alt 4" { GoToTab 4; }
        bind "Alt 5" { GoToTab 5; }
        bind "Alt 6" { GoToTab 6; }
        bind "Alt 7" { GoToTab 7; }
        bind "Alt 8" { GoToTab 8; }
        bind "Alt 9" { GoToTab 9; }
        bind "Alt s" { ToggleActiveSyncTab; }  // 同步输入 (Sync)
        bind "Alt R" { SwitchToMode "RenameTab"; TabNameInput 0; }

        //Session:唤起Tab 和 Session管理器，用箭头选择，Enter 切换;以及Session新建等
        bind "Alt w" { LaunchOrFocusPlugin "session-manager" {
                floating true              // 设置为浮动模式
                move_to_focused_tab true   // 让它跟随当前聚焦的 Tab
            } 
        }
    }
}

// 插件
plugins {
    tab-bar location="zellij:tab-bar"
    status-bar location="zellij:status-bar"
    strider location="zellij:strider"
    compact-bar location="zellij:compact-bar"
    session-manager location="zellij:session-manager"
}
