# --- XDG 规范 ---
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_DATA_HOME="$HOME/.local/share"
export XDG_CACHE_HOME="$HOME/.cache"
export XDG_STATE_HOME="$HOME/.local/state"
export XDG_RUNTIME_DIR="${XDG_RUNTIME_DIR:-/tmp/zsh-$USER}"

# --- Zsh 配置路径 ---
export ZDOTDIR="$XDG_CONFIG_HOME/zsh"
export HISTFILE="$XDG_STATE_HOME/zsh/history"                    # 历史文件位置，供 Atuin 写入和 Zsh 读取
export ZSH_COMPDUMP="$XDG_CACHE_HOME/zsh/zcompdump-$ZSH_VERSION" # 补全转储文件路径

# 确保核心目录存在
mkdir -p "$XDG_STATE_HOME/zsh" "$XDG_CACHE_HOME/zsh" "$XDG_RUNTIME_DIR"

# --- 全局变量 ---
export EDITOR='hx'
export VISUAL='hx'
export LANG=en_US.UTF-8
export PAGER='less'

#bat
export BAT_CONFIG_PATH="$XDG_CONFIG_HOME/bat/config"
#yazi
export YAZI_CONFIG_HOME="$XDG_CONFIG_HOME/yazi"
#less
export LESS='-R -F -X -i -M' #保持颜色，搜索高亮，退出时不清屏(X)，不换行(S)，提示符友好(M)
export LESSHISTFILE="$XDG_STATE_HOME/less/history"
#gnupg
export GNUPGHOME="$XDG_DATA_HOME/gnupg"
#ripgrep
export RIPGREP_CONFIG_PATH="$XDG_CONFIG_HOME/ripgrep/config"
#atuin
export ATUIN_CONFIG_DIR="$XDG_CONFIG_HOME/atuin"
export ATUIN_NOBIND="true" # 禁止 Atuin 自动绑定 Up/Ctrl-R，我们要手动精细控制
#zellij
export ZELLIJ_CONFIG_DIR="$XDG_CONFIG_HOME/zellij"
#Carapace 桥接设置
export CARAPACE_BRIDGES='zsh,bash,inshellisense'

# --- Devbox ---
export DEVBOX_NO_ANALYTICS=1
# --- Mise---
export MISE_DATA_DIR="$XDG_DATA_HOME/mise"
export MISE_CONFIG_DIR="$XDG_CONFIG_HOME/mise"
export MISE_CACHE_DIR="$XDG_CACHE_HOME/mise"

#api-key
export GEMINI_API_KEY="" # 建议通过 1Password 或 keychain 注入

# 编程语言(不覆盖项目配置的home路径)
#rust
export CARGO_HOME="$XDG_DATA_HOME/cargo"
export RUSTUP_HOME="$XDG_DATA_HOME/rustup"
#go
export GOPATH="$XDG_DATA_HOME/go"
export GOMODCACHE="$XDG_CACHE_HOME/go/mod"
#node
export NPM_CONFIG_USERCONFIG="$XDG_CONFIG_HOME/npm/npmrc"
export NODE_REPL_HISTORY="$XDG_DATA_HOME/node_repl_history"
#python
export IPYTHONDIR="$XDG_CONFIG_HOME/ipython"
export PYTHONSTARTUP="$XDG_CONFIG_HOME/python/pythonrc"

# docker
export DOCKER_CONFIG="$XDG_CONFIG_HOME/docker"

# Podman
export DOCKER_HOST="unix://$XDG_RUNTIME_DIR/podman/podman.sock" # 显式指向 Podman Socket，让原本寻找 Docker Socket 的工具找到 Podman
export DOCKER_SOCK="$DOCKER_HOST"                               # 禁用 Docker 内容信任 (Podman 不需要)
export DOCKER_CONTENT_TRUST=0
export TESTCONTAINERS_DOCKER_SOCKET_OVERRIDE="$DOCKER_HOST"     # 兼容 Testcontainers

# --- 路径增强 ---
typeset -U PATH # 确保 PATH 不重复
path=(
  "$HOME/.local/bin"                 # 将用户级 bin 加入 PATH 
  "$CARGO_HOME/bin"
  "$GOPATH/bin"
  $path
)
export PATH

export DO_NOT_TRACK=1
