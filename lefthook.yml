pre-commit:
  parallel: true
  commands:
    # 扫描暂存区中的敏感信息 (API Key等)
    gitleaks:
      run: gitleaks protect --staged --verbose --redact
    # 物理阻断私钥文件提交 (双重保险)
    block-keys:
      run: if git diff --cached --name-only | grep -E 'keys.txt|\.age$|id_rsa'; then echo "❌ 禁止提交私钥/未加密文件!"; exit 1; fi

pre-push:
  commands:
    # 推送前再次全量扫描
    audit:
      run: gitleaks detect --verbose